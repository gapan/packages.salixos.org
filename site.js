"use strict";class Screen{showStartScreen(){document.getElementById("screen-upper").setAttribute("style","display: flex");document.getElementById("screen-lower").setAttribute("style","display: none")}showResultsScreen(){document.getElementById("screen-lower").setAttribute("style","display: flex");document.getElementById("screen-upper").setAttribute("style","display: none")}showSlide(slide){var slides=document.getElementsByClassName("slide");for(var i=0;i<slides.length;i++)document.getElementById(slides[i].id).setAttribute("style","display: none");document.getElementById(slide).setAttribute("style","display: block")}clearSearchBox(){document.getElementById("search").value="";document.getElementById("search").focus()}showSearchBoxMessage(msg){document.getElementById("search").placeholder=msg;document.getElementById("search").style.fontWeight="bold";setTimeout("document.getElementById('search').placeholder = 'Enter search term...';"+"document.getElementById('search').style.fontWeight = 'normal';",2000)}updateProgressBar(version,arch){var currentVersion=spkg.repoList.version;var currentArch=spkg.repoList.arch;if(version===currentVersion&&arch===currentArch){if(spkg.repoList.isReady()){this.hideProgressBar()}else{var progressbar=document.getElementById("searchprogress");var totalRepos=spkg.repoList.repoNames.length;var readyRepos=spkg.repoList.getNumberOfReadyRepos();var width=Math.round(100*readyRepos/totalRepos)+"%";progressbar.style.width=width;document.querySelector("#searchprogressbox em").innerHTML=width}}}showProgressBar(){document.getElementById("searchprogressbox").style.display="inline-flex";document.getElementById("searchbox").style.display="none";document.getElementById("button-browse").style.display="none"}hideProgressBar(){document.getElementById("searchprogressbox").style.display="none";document.getElementById("searchbox").style.display="inline-flex";document.querySelector("#searchprogressbox em").innerHTML="0%";document.getElementById("button-browse").style.display="flex"}}
"use strict";class Repo{constructor(name,url,version,arch){this.name=name;this.url=url;this.version=version;this.arch=arch;this.ready=false;this.description=this.getDescription();this.data=null;this.getData()}getData(){var xhr=new XMLHttpRequest;xhr.open("GET",this.url);var that=this;xhr.addEventListener("readystatechange",function(ev){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status===304){console.log("Got data from "+that.url);that.data=JSON.parse(xhr.responseText);that.ready=true;spkg.screen.updateProgressBar(that.version,that.arch)}else{console.log("Error getting data from "+that.url);document.getElementById("search").placeholder="Error retrieving data. Try reloading the page. :("}}});xhr.send()}getDescription(){var descriptions={"Slackware":"Official Slackware repository (with dependency information)","Salix":"Official Salix package repository","Slackware-Extra":"Extra Slackware package repository","Extra":"Extra Salix package repository","Xfce-4.18":"Xfce 4.18 repository"};return descriptions[this.name]}getPkg(name){for(var i=0;i<this.data.packages.length;i++){var pkg=this.data.packages[i];if(pkg.name===name){return pkg}}return null}}
"use strict";class RepoList{constructor(version,arch){this.version=version;this.arch=arch;this.mirror="https://download.salixos.org/";this.repoNames=["Salix","Slackware","Slackware-Extra"];if(this.version==="14.2"||this.version==="15.0"){this.repoNames.push("Extra")}if(this.version==="15.0"){this.repoNames.push("Xfce-4.18")}spkg.screen.showProgressBar();this.repos=[];for(var i=0;i<this.repoNames.length;i++){var repoName=this.repoNames[i];this.repos.push(new Repo(repoName,this.getJSONURL(repoName),this.version,this.arch))}}getURL(repo){var url=this.mirror+this.arch+"/";if(repo==="Salix"){url+=this.version}else if(repo==="Slackware"){url+="slackware-"+this.version}else if(repo==="Slackware-Extra"){url+="slackware-"+this.version+"/extra"}else if(repo==="Extra"){url+="extra-"+this.version}else if(repo==="Xfce-4.18"){url+="xfce4.18-"+this.version}return url+"/"}getJSONURL(repo){return this.getURL(repo)+"PACKAGES.json"}isReady(){if(this.getNumberOfReadyRepos()===this.repos.length){return true}else{return false}}getNumberOfReadyRepos(){var n=0;for(var i=0;i<this.repos.length;i++){var repo=this.repos[i];if(repo.ready){n++}}return n}getRepo(name){for(var i=0;i<this.repos.length;i++){var repo=this.repos[i];if(repo.name===name){return repo}}return null}}
"use strict";class RepoManager{constructor(){var version=localStorage.getItem("version");if(!version){version=document.getElementById("search-ver").value;localStorage.setItem("version",version)}else{document.getElementById("search-ver").value=version}var arch=localStorage.getItem("arch");if(!arch){arch=document.getElementById("search-arch").value;localStorage.setItem("arch",arch)}else{document.getElementById("search-arch").value=arch}this.repoStore={};spkg.repoList=new RepoList(version,arch);this.repoStore[version+arch]=spkg.repoList}setRepoFromSearchPage(){var version=document.getElementById("search-ver").value;var arch=document.getElementById("search-arch").value;localStorage.setItem("version",version);localStorage.setItem("arch",arch);this.syncRepoSelections(version,arch)}syncRepoSelections(version,arch){if(!this.repoStore[version+arch]){this.repoStore[version+arch]=new RepoList(version,arch)}spkg.repoList=this.repoStore[version+arch];spkg.screen.showSlide("slide-browse-repo")}}
"use strict";function _createForOfIteratorHelper(r,e){var t="undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(!t){if(Array.isArray(r)||(t=_unsupportedIterableToArray(r))||e&&r&&"number"==typeof r.length){t&&(r=t);var _n=0,F=function F(){};return{s:F,n:function n(){return _n>=r.length?{done:!0}:{done:!1,value:r[_n++]}},e:function e(r){throw r},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function s(){t=t.call(r)},n:function n(){var r=t.next();return a=r.done,r},e:function e(r){u=!0,o=r},f:function f(){try{a||null==t.return||t.return()}finally{if(u)throw o}}}}function _unsupportedIterableToArray(r,a){if(r){if("string"==typeof r)return _arrayLikeToArray(r,a);var t={}.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(r,a):void 0}}function _arrayLikeToArray(r,a){(null==a||a>r.length)&&(a=r.length);for(var e=0,n=Array(a);e<a;e++)n[e]=r[e];return n}class Action{pkgSearch(){var searchResults=document.getElementById("slide-search-results-items");var version=document.getElementById("search-ver").value;var arch=document.getElementById("search-arch").value;var termsElm=document.getElementById("search");var terms=termsElm.value.toLowerCase().split(" ");termsElm.value="";var usedTerms=[];var _iterator=_createForOfIteratorHelper(terms),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _term=_step.value;if(_term.length>2){usedTerms.push(_term)}}}catch(err){_iterator.e(err)}finally{_iterator.f()}if(usedTerms.length===0){spkg.screen.showSearchBoxMessage("Search terms are too short!");return}if(!spkg.repoList.isReady()){spkg.screen.showSearchBoxMessage("Oops! Data not downloaded yet!");return}var packageList=[];for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];for(var j=0;j<repo.data.packages.length;j++){var pkg=repo.data.packages[j];var _iterator2=_createForOfIteratorHelper(usedTerms),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var term=_step2.value;if(pkg.name.toLowerCase().indexOf(term)>=0||pkg.descs.toLowerCase().indexOf(term)>=0||pkg.descl.toLowerCase().indexOf(term)>=0){pkg.reponame=repo.name;packageList.push(pkg)}}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}packageList.sort(function(a,b){return a.name>b.name});var iHTML="";if(packageList.length===0){iHTML="<div id=\"noresults\">No results found!</div>"}for(var _i=0;_i<packageList.length;_i++){var _pkg=packageList[_i];iHTML+="<div class=\"item\"";iHTML+="onclick=\"spkg.action.browseSearchedPkg('";iHTML+=_pkg.loc+"','"+_pkg.reponame+"','"+version+"','"+arch;iHTML+="','"+_pkg.name+"','"+_pkg.ver+"','"+_pkg.rel;iHTML+="')\"><div>";iHTML+="<p class=\"name\">"+_pkg.name+"</p>";iHTML+="<p class=\"version\">"+_pkg.ver+"</p>";iHTML+="<p class=\"release\">"+_pkg.rel+"</p>";iHTML+="</div><p class=\"description\">";iHTML+=_pkg.descs;iHTML+="</p></div>"}searchResults.innerHTML=iHTML;spkg.screen.showSlide("slide-search-results");spkg.screen.showResultsScreen()}browseRepoList(){var repoListElm=document.getElementById("repo-list");var version=document.getElementById("search-ver").value;var arch=document.getElementById("search-arch").value;if(!spkg.repoList.isReady()){spkg.screen.showSearchBoxMessage("Oops! Data not downloaded yet!");return}var iHTML="";for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];iHTML+="<div class=\"item\" onclick=\"spkg.action.browseRepo('";iHTML+=repo.name+"','"+version+"','"+arch;iHTML+="')\">";iHTML+="<p class=\"name\">"+repo.name+"</p>";iHTML+="<p class=\"description\">";iHTML+=repo.description;iHTML+="</p></div>"}repoListElm.innerHTML=iHTML;spkg.screen.showSlide("slide-browse-repo")}browseRepo(name,version,arch){var locationItems=document.getElementById("slide-browse-location-items");var iHTML="";for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];if(repo.name===name){var keys=Object.keys(repo.data.locations);keys.sort();for(var j=0;j<keys.length;j++){var loc=keys[j];var description=repo.data.locations[loc];iHTML+="<div class=\"item\" onclick=\"spkg.action.browseLocation('";iHTML+=loc+"','"+name+"','"+version+"','"+arch;iHTML+="')\">";iHTML+="<p class=\"name\">";iHTML+=loc;iHTML+="</p>";iHTML+="<p class=\"description\">";iHTML+=description;iHTML+="</p></div>"}break}}locationItems.innerHTML=iHTML;spkg.screen.showSlide("slide-browse-location")}browseLocation(loc,name,version,arch){var packageItems=document.getElementById("slide-browse-package-items");var packageList=[];for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];if(repo.name===name){for(var j=0;j<repo.data.packages.length;j++){var pkg=repo.data.packages[j];if(pkg.loc===loc){packageList.push(pkg)}}break}}packageList.sort(function(a,b){return a.name>b.name});var iHTML="";for(var _i2=0;_i2<packageList.length;_i2++){var _pkg2=packageList[_i2];iHTML+="<div class=\"item\"";iHTML+="onclick=\"spkg.action.browsePkg('";iHTML+=loc+"','"+name+"','"+version+"','"+arch;iHTML+="','"+_pkg2.name+"','"+_pkg2.ver+"','"+_pkg2.rel;iHTML+="')\"><div>";iHTML+="<p class=\"name\">"+_pkg2.name+"</p>";iHTML+="<p class=\"version\">"+_pkg2.ver+"</p>";iHTML+="<p class=\"release\">"+_pkg2.rel+"</p>";iHTML+="</div><p class=\"description\">";iHTML+=_pkg2.descs;iHTML+="</p></div>"}packageItems.innerHTML=iHTML;spkg.screen.showSlide("slide-browse-package")}browsePkg(loc,reponame,version,arch,pkgname,pkgver,pkgrel){var pkgDetails=document.getElementById("slide-browse-details-item");pkgDetails.innerHTML=this.getPkgInnerHTML(loc,reponame,version,arch,pkgname,pkgver,pkgrel);spkg.screen.showSlide("slide-browse-details")}browseSearchedPkg(loc,reponame,version,arch,pkgname,pkgver,pkgrel){var pkgDetails=document.getElementById("slide-search-details-item");pkgDetails.innerHTML=this.getPkgInnerHTML(loc,reponame,version,arch,pkgname,pkgver,pkgrel);spkg.screen.showSlide("slide-search-details")}getPkgInnerHTML(loc,reponame,version,arch,pkgname,pkgver,pkgrel){var iHTML="";for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];if(repo.name===reponame){for(var j=0;j<repo.data.packages.length;j++){var pkg=repo.data.packages[j];if(pkg.name===pkgname&&pkg.ver===pkgver&&pkg.rel===pkgrel){iHTML+="<div class=\"info\"><h1>Name:</h1><p>";iHTML+=pkg.name+"</p></div>";iHTML+="<div class=\"info\"><h1>Version:</h1><p>";iHTML+=pkg.ver+"</p></div>";iHTML+="<div class=\"info\"><h1>Release:</h1><p>";iHTML+=pkg.rel+"</p></div>";iHTML+="<div class=\"info\"><h1>Repository:</h1><p>";iHTML+=reponame+" "+version+" ("+arch+")</p></div>";iHTML+="<div class=\"info\"><h1>Location:</h1><p>";iHTML+=pkg.loc+"</p></div>";iHTML+="<div class=\"info\"><h1>Package Size:</h1><p>";iHTML+=pkg.sizec+"</p></div>";iHTML+="<div class=\"info\"><h1>Installed Size:</h1><p>";iHTML+=pkg.sizeu+"</p></div>";iHTML+="<div class=\"download\"><p><a href=\"";iHTML+=spkg.repoList.getURL(reponame)+pkg.path+"\" type=\"application/octet-stream\" download>Download</a> <a href=\"";iHTML+=spkg.repoList.getURL(reponame)+pkg.source+"\">Source</a></p>";iHTML+="<div class=\"text\"><p><i>Right click on the Download link and select Save as...</i></p></div>";iHTML+="</div>";iHTML+="<div class=\"info\"><h1>Description:</h1>";iHTML+="<div class=\"text\"><p>";iHTML+=pkg.descs+"</p><p>";iHTML+=pkg.descl+"</p></div></div>";if(pkg.deps){iHTML+="<div class=\"info\"><h1>Dependencies:</h1><div class=\"deps\">";for(var k=0;k<pkg.deps.length;k++){var dep=pkg.deps[k];if(dep instanceof Array){iHTML+="<div class=\"depgroup\">";for(var l=0;l<dep.length;l++){iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=dep[l]+"</a> "}iHTML+="</div>"}else{iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=dep+"</a> "}}iHTML+="</div></div>"}if(pkg.sug){iHTML+="<div class=\"info\"><h1>Suggests:</h1><div class=\"deps\">";for(var _k=0;_k<pkg.sug.length;_k++){var sug=pkg.sug[_k];iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=sug+"</a> "}iHTML+="</div></div>"}if(pkg.con){iHTML+="<div class=\"info\"><h1>Conflicts:</h1><div class=\"deps\">";for(var _k2=0;_k2<pkg.con.length;_k2++){var con=pkg.con[_k2];iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=con+"</a> "}iHTML+="</div></div>"}break}}break}}return iHTML}viewDep(name,arch,version){var repos=["Salix","Xfce-4.18","Extra","Slackware","Slackware-Extra"];for(var _i3=0,_repos=repos;_i3<_repos.length;_i3++){var repoName=_repos[_i3];var repo=spkg.repoList.getRepo(repoName);if(repo){var pkg=repo.getPkg(name);if(pkg){this.browseSearchedPkg(pkg.loc,repo.name,version,arch,pkg.name,pkg.ver,pkg.rel);return}}}}}
"use strict";var spkg={};spkg.screen=new Screen;spkg.repoManager=new RepoManager;spkg.action=new Action;document.getElementById("search").onkeypress=function(e){if(e.keyCode==13){document.getElementById("submit").click();return false}return true};document.getElementById("submit").addEventListener("click",function(){spkg.action.pkgSearch()});document.getElementById("search-ver").addEventListener("change",function(){spkg.repoManager.setRepoFromSearchPage()});document.getElementById("search-arch").addEventListener("change",function(){spkg.repoManager.setRepoFromSearchPage()});document.getElementById("button-browse").addEventListener("click",function(){spkg.action.browseRepoList();spkg.screen.showSlide("slide-browse-repo");spkg.screen.showResultsScreen()});document.getElementById("button-go-to-search").addEventListener("click",function(){spkg.screen.showStartScreen()});document.getElementById("left-arrow-browse-location").addEventListener("click",function(){spkg.screen.showSlide("slide-browse-repo")});document.getElementById("left-arrow-browse-package").addEventListener("click",function(){spkg.screen.showSlide("slide-browse-location")});document.getElementById("left-arrow-browse-details").addEventListener("click",function(){spkg.screen.showSlide("slide-browse-package")});document.getElementById("left-arrow-search-details").addEventListener("click",function(){spkg.screen.showSlide("slide-search-results")});
