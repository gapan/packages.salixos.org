"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Screen=function(){function Screen(){_classCallCheck(this,Screen)}_createClass(Screen,[{key:"scrollToId",value:function scrollToId(elem){document.getElementById(elem).scrollIntoView({block:"start",behavior:"smooth"})}},{key:"showSlide",value:function showSlide(slide){var slides=document.getElementsByClassName("slide");for(var i=0;i<slides.length;i++){document.getElementById(slides[i].id).setAttribute("style","display: none")}document.getElementById(slide).setAttribute("style","display: block");this.scrollToId(slide)}},{key:"scrollUp",value:function scrollUp(){document.getElementById("search").value="";document.getElementById("search").focus();this.scrollToId("screen-upper")}},{key:"showSearchBoxMessage",value:function showSearchBoxMessage(msg){document.getElementById("search").placeholder=msg;document.getElementById("search").style.fontWeight="bold";setTimeout("document.getElementById('search').placeholder = 'Enter search term...';"+"document.getElementById('search').style.fontWeight = 'normal';",2000)}},{key:"noBackButton",value:function noBackButton(win){if(typeof win==="undefined"){throw new Error("window is undefined")}var _hash="!";var noBackPlease=function noBackPlease(){win.setTimeout(function(){win.location.href+="#"},50)};win.onhashchange=function(){if(win.location.hash!==_hash){win.location.hash=_hash}};win.onload=function(){noBackPlease();document.body.onkeydown=function(e){var elm=e.target.nodeName.toLowerCase();if(e.which===8&&elm!=="input"&&elm!=="textarea"){e.preventDefault()}e.stopPropagation()}}}}]);return Screen}();
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Repo=function(){function Repo(name,url){_classCallCheck(this,Repo);this.name=name;this.url=url;this.ready=false;this.description=this.getDescription();this.data=null;this.getData(url)}_createClass(Repo,[{key:"getData",value:function getData(url){var xhr=new XMLHttpRequest;xhr.open("GET",url);var that=this;xhr.addEventListener("readystatechange",function(ev){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status===304){console.log("Got data from "+url);that.data=JSON.parse(xhr.responseText);that.ready=true}else{console.log("Error getting data from "+url);document.getElementById("search").placeholder="Error retrieving data. Try reloading the page. :("}}});xhr.send()}},{key:"getDescription",value:function getDescription(){var descriptions={"Slackware":"Official Slackware repository (with dependency information)","Salix":"Official Salix package repository","Slackware-Extra":"Extra Slackware package repository","Extra":"Extra Salix package repository"};return descriptions[this.name]}},{key:"getPkg",value:function getPkg(name){for(var i=0;i<this.data.packages.length;i++){var pkg=this.data.packages[i];if(pkg.name===name){return pkg}}return null}}]);return Repo}();
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RepoList=function(){function RepoList(version,arch){_classCallCheck(this,RepoList);this.version=version;this.arch=arch;this.mirror="http://download.salixos.org/";this.repoNames=["Salix","Slackware","Slackware-Extra"];if(this.version>=14.2){this.repoNames.push("Extra")}this.repos=[];for(var i=0;i<this.repoNames.length;i++){var repoName=this.repoNames[i];this.repos.push(new Repo(repoName,this.getURL(repoName)))}}_createClass(RepoList,[{key:"getURL",value:function getURL(repo){var url=this.mirror+this.arch+"/";if(repo==="Salix"){url+=this.version}else if(repo==="Slackware"){url+="slackware-"+this.version}else if(repo==="Slackware-Extra"){url+="slackware-"+this.version+"/extra"}else if(repo==="Extra"){url+="extra-"+this.version}url+="/PACKAGES.json";return url}},{key:"isReady",value:function isReady(){var n=0;for(var i=0;i<this.repos.length;i++){var repo=this.repos[i];if(repo.ready){n++}}if(n===this.repos.length){return true}else{return false}}},{key:"getRepo",value:function getRepo(name){for(var i=0;i<this.repos.length;i++){var repo=this.repos[i];if(repo.name===name){return repo}}return null}}]);return RepoList}();
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var RepoManager=function(){function RepoManager(){_classCallCheck(this,RepoManager);var version=document.getElementById("search-ver").value;var arch=document.getElementById("search-arch").value;this.repoStore={};spkg.repoList=new RepoList(version,arch);this.repoStore[version+arch]=spkg.repoList}_createClass(RepoManager,[{key:"setRepoFromSearchPage",value:function setRepoFromSearchPage(){var version=document.getElementById("search-ver").value;var arch=document.getElementById("search-arch").value;var otherVersion=document.getElementById("browse-ver");var otherArch=document.getElementById("browse-arch");this.syncRepoSelections(version,arch,otherVersion,otherArch)}},{key:"setRepoFromBrowsePage",value:function setRepoFromBrowsePage(){var version=document.getElementById("browse-ver").value;var arch=document.getElementById("browse-arch").value;var otherVersion=document.getElementById("search-ver");var otherArch=document.getElementById("search-arch");this.syncRepoSelections(version,arch,otherVersion,otherArch)}},{key:"syncRepoSelections",value:function syncRepoSelections(version,arch,otherVersionElm,otherArchElm){for(var i=0;i<otherVersionElm.options.length;i++){if(otherVersionElm.options[i].innerHTML===version){otherVersionElm.selectedIndex=i;break}}for(var _i=0;_i<otherArchElm.options.length;_i++){if(otherArchElm.options[_i].innerHTML===arch){otherArchElm.selectedIndex=_i;break}}if(!this.repoStore[version+arch]){this.repoStore[version+arch]=new RepoList(version,arch)}spkg.repoList=this.repoStore[version+arch]}}]);return RepoManager}();
"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}var Action=function(){function Action(){_classCallCheck(this,Action)}_createClass(Action,[{key:"pkgSearch",value:function pkgSearch(){var searchResults=document.getElementById("slide-search-results-items");var version=document.getElementById("search-ver").value;var arch=document.getElementById("search-arch").value;var termsElm=document.getElementById("search");var terms=termsElm.value.toLowerCase().split(" ");termsElm.value="";var usedTerms=[];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=terms[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){var term=_step.value;if(term.length>2){usedTerms.push(term)}}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}if(usedTerms.length===0){spkg.screen.showSearchBoxMessage("Search terms are too short!");return}if(!spkg.repoList.isReady()){spkg.screen.showSearchBoxMessage("Oops! Data not downloaded yet!");return}var packageList=[];for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];for(var j=0;j<repo.data.packages.length;j++){var pkg=repo.data.packages[j];var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=usedTerms[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){var _term=_step2.value;if(pkg.name.toLowerCase().indexOf(_term)>=0||pkg.descs.toLowerCase().indexOf(_term)>=0||pkg.descl.toLowerCase().indexOf(_term)>=0){pkg.reponame=repo.name;packageList.push(pkg)}}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}}}packageList.sort(function(a,b){return a.name>b.name});var iHTML="";if(packageList.length===0){iHTML="<div id=\"noresults\">No results found!</div>"}for(var _i=0;_i<packageList.length;_i++){var _pkg=packageList[_i];iHTML+="<div class=\"item\"";iHTML+="onclick=\"spkg.action.browseSearchedPkg('";iHTML+=_pkg.loc+"','"+_pkg.reponame+"','"+version+"','"+arch;iHTML+="','"+_pkg.name+"','"+_pkg.ver+"','"+_pkg.rel;iHTML+="')\"><div>";iHTML+="<p class=\"name\">"+_pkg.name+"</p>";iHTML+="<p class=\"version\">"+_pkg.ver+"</p>";iHTML+="<p class=\"release\">"+_pkg.rel+"</p>";iHTML+="</div><p class=\"description\">";iHTML+=_pkg.descs;iHTML+="</p></div>"}searchResults.innerHTML=iHTML;spkg.screen.showSlide("slide-search-results");spkg.screen.scrollToId("screen-lower")}},{key:"browseRepoList",value:function browseRepoList(){var repoListElm=document.getElementById("repo-list");var version=document.getElementById("browse-ver").value;var arch=document.getElementById("browse-arch").value;if(!spkg.repoList.isReady()){spkg.screen.showSearchBoxMessage("Oops! Data not downloaded yet!");return}var iHTML="";for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];iHTML+="<div class=\"item\" onclick=\"spkg.action.browseRepo('";iHTML+=repo.name+"','"+version+"','"+arch;iHTML+="')\">";iHTML+="<p class=\"name\">"+repo.name+"</p>";iHTML+="<p class=\"description\">";iHTML+=repo.description;iHTML+="</p></div>"}repoListElm.innerHTML=iHTML;spkg.screen.showSlide("slide-browse-repo")}},{key:"browseRepo",value:function browseRepo(name,version,arch){var locationItems=document.getElementById("slide-browse-location-items");var iHTML="";for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];if(repo.name===name){var keys=Object.keys(repo.data.locations);keys.sort();for(var j=0;j<keys.length;j++){var loc=keys[j];var description=repo.data.locations[loc];iHTML+="<div class=\"item\" onclick=\"spkg.action.browseLocation('";iHTML+=loc+"','"+name+"','"+version+"','"+arch;iHTML+="')\">";iHTML+="<p class=\"name\">";iHTML+=loc;iHTML+="</p>";iHTML+="<p class=\"description\">";iHTML+=description;iHTML+="</p></div>"}break}}locationItems.innerHTML=iHTML;spkg.screen.showSlide("slide-browse-location")}},{key:"browseLocation",value:function browseLocation(loc,name,version,arch){var packageItems=document.getElementById("slide-browse-package-items");var packageList=[];for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];if(repo.name===name){for(var j=0;j<repo.data.packages.length;j++){var pkg=repo.data.packages[j];if(pkg.loc===loc){packageList.push(pkg)}}break}}packageList.sort(function(a,b){return a.name>b.name});var iHTML="";for(var _i2=0;_i2<packageList.length;_i2++){var _pkg2=packageList[_i2];iHTML+="<div class=\"item\"";iHTML+="onclick=\"spkg.action.browsePkg('";iHTML+=loc+"','"+name+"','"+version+"','"+arch;iHTML+="','"+_pkg2.name+"','"+_pkg2.ver+"','"+_pkg2.rel;iHTML+="')\"><div>";iHTML+="<p class=\"name\">"+_pkg2.name+"</p>";iHTML+="<p class=\"version\">"+_pkg2.ver+"</p>";iHTML+="<p class=\"release\">"+_pkg2.rel+"</p>";iHTML+="</div><p class=\"description\">";iHTML+=_pkg2.descs;iHTML+="</p></div>"}packageItems.innerHTML=iHTML;spkg.screen.showSlide("slide-browse-package")}},{key:"browsePkg",value:function browsePkg(loc,reponame,version,arch,pkgname,pkgver,pkgrel){var pkgDetails=document.getElementById("slide-browse-details-item");pkgDetails.innerHTML=this.getPkgInnerHTML(loc,reponame,version,arch,pkgname,pkgver,pkgrel);spkg.screen.showSlide("slide-browse-details")}},{key:"browseSearchedPkg",value:function browseSearchedPkg(loc,reponame,version,arch,pkgname,pkgver,pkgrel){var pkgDetails=document.getElementById("slide-search-details-item");pkgDetails.innerHTML=this.getPkgInnerHTML(loc,reponame,version,arch,pkgname,pkgver,pkgrel);spkg.screen.showSlide("slide-search-details")}},{key:"getPkgInnerHTML",value:function getPkgInnerHTML(loc,reponame,version,arch,pkgname,pkgver,pkgrel){var iHTML="";for(var i=0;i<spkg.repoList.repos.length;i++){var repo=spkg.repoList.repos[i];if(repo.name===reponame){for(var j=0;j<repo.data.packages.length;j++){var pkg=repo.data.packages[j];if(pkg.name===pkgname&&pkg.ver===pkgver&&pkg.rel===pkgrel){iHTML+="<div class=\"info\"><h1>Name:</h1><p>";iHTML+=pkg.name+"</p></div>";iHTML+="<div class=\"info\"><h1>Version:</h1><p>";iHTML+=pkg.ver+"</p></div>";iHTML+="<div class=\"info\"><h1>Release:</h1><p>";iHTML+=pkg.rel+"</p></div>";iHTML+="<div class=\"info\"><h1>Repository:</h1><p>";iHTML+=reponame+" "+version+" ("+arch+")</p></div>";iHTML+="<div class=\"info\"><h1>Location:</h1><p>";iHTML+=pkg.loc+"</p></div>";iHTML+="<div class=\"info\"><h1>Package Size:</h1><p>";iHTML+=pkg.sizec+"</p></div>";iHTML+="<div class=\"info\"><h1>Installed Size:</h1><p>";iHTML+=pkg.sizeu+"</p></div>";iHTML+="<div class=\"info\"><h1>Description:</h1>";iHTML+="<div class=\"text\"><p>";iHTML+=pkg.descs+"</p><p>";iHTML+=pkg.descl+"</p></div></div>";if(pkg.deps){iHTML+="<div class=\"info\"><h1>Dependencies:</h1><div class=\"deps\">";for(var k=0;k<pkg.deps.length;k++){var dep=pkg.deps[k];if(dep instanceof Array){iHTML+="<div class=\"depgroup\">";for(var l=0;l<dep.length;l++){iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=dep[l]+"</a> "}iHTML+="</div>"}else{iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=dep+"</a> "}}iHTML+="</div></div>"}if(pkg.sug){iHTML+="<div class=\"info\"><h1>Suggests:</h1><div class=\"deps\">";for(var _k=0;_k<pkg.sug.length;_k++){var sug=pkg.sug[_k];iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=sug+"</a> "}iHTML+="</div></div>"}if(pkg.con){iHTML+="<div class=\"info\"><h1>Conflicts:</h1><div class=\"deps\">";for(var _k2=0;_k2<pkg.con.length;_k2++){var con=pkg.con[_k2];iHTML+="<a href=\"javascript:void(0)\"";iHTML+="onclick=\"spkg.action.viewDep(this.innerHTML,'";iHTML+=arch+"','"+version+"')\">";iHTML+=con+"</a> "}iHTML+="</div></div>"}break}}break}}return iHTML}},{key:"viewDep",value:function viewDep(name,arch,version){var repos=["Salix","Extra","Slackware","Slackware-Extra"];var _iteratorNormalCompletion3=true;var _didIteratorError3=false;var _iteratorError3=undefined;try{for(var _iterator3=repos[Symbol.iterator](),_step3;!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=true){var repoName=_step3.value;var repo=spkg.repoList.getRepo(repoName);if(repo){var pkg=repo.getPkg(name);if(pkg){this.browseSearchedPkg(pkg.loc,repo.name,version,arch,pkg.name,pkg.ver,pkg.rel);return}}}}catch(err){_didIteratorError3=true;_iteratorError3=err}finally{try{if(!_iteratorNormalCompletion3&&_iterator3.return){_iterator3.return()}}finally{if(_didIteratorError3){throw _iteratorError3}}}}}]);return Action}();
"use strict";var spkg={};spkg.repoManager=new RepoManager;spkg.screen=new Screen;spkg.action=new Action;document.getElementById("search").onkeypress=function(e){if(e.keyCode==13){document.getElementById("submit").click();return false}return true};spkg.screen.noBackButton(window);
